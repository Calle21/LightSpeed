safe (<Fail | A> s) = typecase s
                        A -> s
                        otherwise
                        error "Apparently not safe"
